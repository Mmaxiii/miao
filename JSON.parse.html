<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

</head>

<body>

  <script>
    function parseObj(str) {
      let result = {}
      let key = ''
      let val = ''
      let start
      for (let i = 0; i < str.length; i++) {
        if (str[i] == '"') {
          start = i + 1
          i = getRange(str, start, str[i]) // 找到当前数据类型的结束位置
          key = str.slice(start, i)
        } else if (str[i] == ':') {
          i++
          let start
          if (str[i] == '[') {
            start = i
            i = getRange(str, start + 1, str[i])
          } else if (str[i] == '{') {
            let objCount = 1
            start = i
            i = getRange(str, start + 1, str[i])
          } else {
            start = i
            while (str[i] != ',' && str[i] != '}' && i < str.length) {
              i++
            }
          }
          val = parse(str.slice(start, i))
          result[key] = val
        }
      }
      return result
    }

    function parse(str) {
      let result = ''
      if (str[0] == '{') {
        result = parseObj(str.slice(1, str.length - 1))
      } else if (str[0] == '[') {
        result = parseAry(str.slice(1, str.length - 1))
      } else if (str[0] == '"') {
        result = str.slice(1, str.length - 1)
      } else {
        if (str[str.length - 1] == ',') str = str.slice(0, str.length - 1)
        result = Number(str)
      }
      return result
    }
    function parseAry(str) {
      let result = []
      let val = ''
      for (let i = 0; i < str.length; i++) {
        if (str[i] == '{') {
          let objCount = 1
          let start = i
          i = getRange(str, start + 1, str[i])
          result.push(parse(str.slice(start, i)))
        } else if (str[i] == '[') {
          let aryCount = 1
          let start = i
          i = getRange(str, start + 1, str[i])
          result.push(parse(str.slice(start, i)))
        } else if (str[i] == ',') {
          result.push(parse(val))
          val = ''
        } else {
          val += str[i]
        }
      }
      if (str[str.length - 1] != '}' && str[str.length - 1] != ']') result.push(parse(val))
      return result
    }
    function getRange(str, start, typeStart) {
      let toMore
      let toLess
      let end = start
      if (typeStart == '"') {
        while (str[end] != '"') {
          end++
        }
      } else {
        let count = 1
        if (typeStart == '[') {
          toMore = '['
          toLess = ']'
        } else if (typeStart == '{') {
          toMore = '{'
          toLess = '}'
        }
        while (count != 0) {
          if (str[end] == toMore) count++
          if (str[end] == toLess) count--
          end++
        }
      }
      return end
    }
  </script>
</body>

</html>